"use strict";(()=>{var e={};e.id=994,e.ids=[994],e.modules={8432:e=>{e.exports=require("bcryptjs")},9344:e=>{e.exports=require("jsonwebtoken")},8013:e=>{e.exports=require("mongodb")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,n)=>{Object.defineProperty(n,"l",{enumerable:!0,get:function(){return function e(n,r){return r in n?n[r]:"then"in n&&"function"==typeof n.then?n.then(n=>e(n,r)):"function"==typeof n&&"default"===r?n:void 0}}})},4702:(e,n,r)=>{r.r(n),r.d(n,{config:()=>c,default:()=>P,routeModule:()=>A});var t={};r.r(t),r.d(t,{default:()=>f});var o=r(1802),i=r(7153),s=r(6249),u=r(8432),a=r.n(u),d=r(9344),p=r.n(d),l=r(8013);async function f(e,n){if("POST"!==e.method)return n.status(405).end();let{email:r,password:t}=e.body,o=(await l.MongoClient.connect(process.env.MONGO_URI)).db(),i=await o.collection("users").findOne({email:r});if(!i)return n.status(404).json({error:"Email not found"});if(!await a().compare(t,i.passwordHash))return n.status(401).json({error:"Wrong password"});let s=p().sign({userId:i._id},process.env.JWT_SECRET,{expiresIn:"7d"});n.json({token:s})}let P=(0,s.l)(t,"default"),c=(0,s.l)(t,"config"),A=new o.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/login",pathname:"/api/login",bundlePath:"",filename:""},userland:t})},7153:(e,n)=>{var r;Object.defineProperty(n,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,n,r)=>{e.exports=r(145)}};var n=require("../../webpack-api-runtime.js");n.C(e);var r=n(n.s=4702);module.exports=r})();